<!DOCTYPE html>
<html lang="de">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Rischis Kiosk">
  <meta name="format-detection" content="telephone=no">
  <meta name="theme-color" content="#0f172a">
  <title>Adminbereich – Rischis Kiosk</title>
  <meta name="description" content="Produkte und Spielrunden verwalten" />
  <link rel="stylesheet" href="dist/style.css">
  <link rel="stylesheet" href="components.css">
  <script src="dist/admin.js" defer></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Poppins:wght@700&display=swap"
    rel="stylesheet">
  <link rel="icon" href="favicon.jpeg" type="image/jpeg">
  <!-- All inline and duplicate CSS removed. Only external CSS is used. -->
</head>

<body
  class="min-h-screen flex items-center justify-center text-green-900 relative dark:text-white bg-gradient-to-br from-green-50 via-cyan-100 to-green-200 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900"
  role="main" aria-label="Adminbereich">
  <a href="#main-content"
    class="skip-link absolute left-2 top-2 bg-cyan-100 text-cyan-900 px-3 py-1 rounded z-50 focus:translate-y-0 -translate-y-12 focus:outline-none focus:ring-2 focus:ring-cyan-400 transition-all"
    tabindex="0">Zum Inhalt springen</a>
  <div class="fixed bottom-4 right-4 z-50">
    <button id="profile-btn" class="bg-cyan-500 hover:bg-cyan-600 text-white rounded-full shadow-lg w-14 h-14 flex items-center justify-center text-2xl focus:outline-none focus:ring-2 focus:ring-cyan-400 transition" aria-label="Profileinstellungen" title="Profileinstellungen">
      <svg xmlns='http://www.w3.org/2000/svg' class='w-7 h-7' fill='none' viewBox='0 0 24 24' stroke='currentColor'>
        <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M5.121 17.804A13.937 13.937 0 0112 15c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0z' />
      </svg>
    </button>
    <div id="profile-modal" class="fixed inset-0 bg-black/70 flex items-center justify-center z-50 hidden" role="dialog" aria-modal="true" aria-labelledby="profile-title">
      <div class="bg-gray-900 text-white rounded-2xl p-6 max-w-md w-full shadow-xl relative animate-fade-in border border-cyan-900">
        <button id="profile-close" class="absolute top-3 right-3 text-2xl text-gray-400 hover:text-cyan-500 focus:outline-none">&times;</button>
        <h2 id="profile-title" class="text-xl font-bold mb-4 text-cyan-300 flex items-center gap-2">
          <svg xmlns='http://www.w3.org/2000/svg' class='w-6 h-6 text-cyan-400' fill='none' viewBox='0 0 24 24' stroke='currentColor'>
            <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M5.121 17.804A13.937 13.937 0 0112 15c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0z' />
          </svg>
          Profileinstellungen
        </h2>
        <div class="space-y-6">
          <form id="profile-image-form" class="space-y-2">
            <label for="profile-image-url" class="block text-sm font-medium text-cyan-200">Profilbild-URL</label>
            <div class="flex items-center gap-3 mt-1">
              <input type="url" id="profile-image-url" name="profile_image_url" class="block w-full rounded-md border-gray-700 bg-gray-800 text-white shadow-sm focus:ring-cyan-400 focus:border-cyan-400 placeholder-gray-400" placeholder="https://..." />
              <img id="profile-image-preview" src="" alt="Vorschau" class="w-12 h-12 rounded-full border border-gray-700 object-cover hidden" style="background:#222;" />
            </div>
            <div id="profile-image-error" class="text-xs text-red-500 mt-1"></div>
            <button type="submit" class="btn-main w-full">Profilbild speichern</button>
            <div id="profile-image-message" class="mt-1 text-center text-sm"></div>
          </form>
          <form id="profile-name-form" class="space-y-2">
            <label for="profile-username" class="block text-sm font-medium text-cyan-200">Benutzername</label>
            <input type="text" id="profile-username" name="username" class="mt-1 block w-full rounded-md border-gray-700 bg-gray-800 text-white shadow-sm focus:ring-cyan-400 focus:border-cyan-400 placeholder-gray-400" required />
            <button type="submit" class="btn-main w-full">Name speichern</button>
            <div id="profile-name-message" class="mt-1 text-center text-sm"></div>
          </form>
          <form id="profile-password-form" class="space-y-2">
            <label for="profile-password" class="block text-sm font-medium text-cyan-200">Neues Passwort</label>
            <input type="password" id="profile-password" name="password" class="mt-1 block w-full rounded-md border-gray-700 bg-gray-800 text-white shadow-sm focus:ring-cyan-400 focus:border-cyan-400 placeholder-gray-400" autocomplete="new-password" />
            <label for="profile-password-repeat" class="block text-sm font-medium text-cyan-200">Passwort wiederholen</label>
            <input type="password" id="profile-password-repeat" name="password-repeat" class="mt-1 block w-full rounded-md border-gray-700 bg-gray-800 text-white shadow-sm focus:ring-cyan-400 focus:border-cyan-400 placeholder-gray-400" autocomplete="new-password" />
            <button type="submit" class="btn-main w-full">Passwort speichern</button>
            <div id="profile-password-message" class="mt-1 text-center text-sm"></div>
          </form>
        </div>
      </div>
    </div>
  </div>
  <div class="fixed top-4 left-4 z-50" role="navigation">
    <a href="dashboard.html"
      class="btn-main flex items-center gap-2 py-2 px-4 text-sm shadow focus:ring-2 focus:ring-cyan-400">
      <svg xmlns='http://www.w3.org/2000/svg' class='w-5 h-5' fill='none' viewBox='0 0 24 24' stroke='currentColor'>
        <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M15 19l-7-7 7-7' />
      </svg>
      Zurück zum Dashboard
    </a>
  </div>
  <!-- Add to header/navbar -->
  <!-- Entferne Logout-Button aus dem Header -->

  <main id="main-content"
    class="text-center p-3 sm:p-6 max-w-2xl w-full rounded-2xl panel-shadow glass-effect space-y-6 animate-fade-in border border-green-200 dark:border-green-900 mx-2 overflow-y-auto max-h-[90vh] flex-shrink-0"
    tabindex="-1">
    <h1
      class="text-3xl sm:text-4xl font-bold mb-8 text-center text-green-800 dark:text-green-300 flex items-center justify-center gap-2"
      id="admin-title">
      <svg xmlns='http://www.w3.org/2000/svg' class='inline w-9 h-9 text-green-500' fill='none' viewBox='0 0 24 24'
        stroke='currentColor'>
        <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M3 10h18M9 6h6m-6 8h6m-6 4h6' />
      </svg>
      Adminbereich
    </h1>
    <div id="stats" class="mb-6"></div>
    <nav id="admin-tabs" class="flex flex-wrap gap-2 justify-center mb-6" aria-label="Admin Tabs">
      <button class="btn-main px-4 py-2 text-sm" data-tab="products">Produkte</button>
      <button class="btn-main px-4 py-2 text-sm" data-tab="purchases">Käufe</button>
      <button class="btn-main px-4 py-2 text-sm" data-tab="users">Nutzer</button>
      <button class="btn-main px-4 py-2 text-sm" data-tab="balance">Guthaben</button>
      <button class="btn-main px-4 py-2 text-sm" data-tab="buy-for-user">Kauf für Nutzer</button>
    </nav>
    <section id="section-products" class="mb-8 tab-content" style="display:none;">
      <h2 class="text-lg sm:text-xl font-semibold mb-4">Produkte verwalten</h2>
      <ul id="product-list" class="space-y-4"></ul>
    </section>
    <section id="section-purchases" class="mb-8 tab-content" style="display:none;">
      <h2 class="text-lg sm:text-xl font-semibold mb-4">Käufe verwalten</h2>
      <div class="flex flex-col sm:flex-row gap-2 mb-4">
        <div class="flex flex-col w-full sm:w-64">
          <input id="purchase-search" type="text" placeholder="Suche nach Nutzer, Produkt, Datum oder Preis..."
            class="p-2 border rounded w-full" />
          <span class="text-xs text-gray-500 mt-1">Du kannst nach Nutzer, Produkt, Datum (z.B. 16.08.2025) oder Preis
            suchen.</span>
        </div>
        <button id="export-purchases"
          class="bg-cyan-600 text-white px-3 py-1 rounded shadow hover:bg-cyan-700 text-xs">Export (CSV)</button>
      </div>
      <ul id="purchase-history" class="space-y-2 text-sm"></ul>
      <button id="load-more-purchases" class="mt-4 text-blue-600 hover:underline text-sm">Weitere anzeigen</button>
    </section>
    <section id="section-users" class="mb-8 tab-content" style="display:none;">
      <h2 class="text-lg sm:text-xl font-semibold mb-4">Benutzernamen und Passwörter verwalten</h2>
      <div class="flex flex-col sm:flex-row gap-2 mb-4">
        <input id="user-search" type="text" placeholder="Benutzer suchen..."
          class="p-2 border rounded w-full sm:w-64" />
        <button id="export-users"
          class="bg-cyan-600 text-white px-3 py-1 rounded shadow hover:bg-cyan-700 text-xs">Export (CSV)</button>
      </div>
      <ul id="user-manage-list" class="space-y-4"></ul>
    </section>
    <section id="section-balance" class="mb-8 tab-content" style="display:none;">
      <h2 class="text-lg sm:text-xl font-semibold mb-4">Guthaben verwalten</h2>
      <ul id="balance-control-list" class="space-y-2 text-sm"></ul>
    </section>
    <section id="section-buy-for-user" class="mb-8 tab-content" style="display:none;">
      <h2 class="text-lg sm:text-xl font-semibold mb-4">Kauf für Nutzer</h2>
      <div class="flex flex-col sm:flex-row items-center gap-2 mb-4">
        <select id="buy-user" class="p-2 border rounded flex-1" aria-label="Nutzer auswählen"></select>
        <input type="text" id="buy-product-search" placeholder="Produkt suchen..." class="p-2 border rounded flex-1"
          aria-label="Produkt suchen" />
      </div>
      <div id="buy-product-list" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"></div>
      <p id="buy-for-user-result" class="mt-2 text-sm"></p>
    </section>
  </main>
  <!-- Loader and Toast for feedback -->
  <div id="loader" class="fixed inset-0 bg-black/40 flex items-center justify-center z-50 hidden">
    <div class="w-16 h-16 border-4 border-cyan-400 border-t-transparent rounded-full animate-spin"></div>
  </div>
  <div id="toast"
    class="fixed left-1/2 top-6 z-50 -translate-x-1/2 px-6 py-3 rounded-lg shadow-lg text-center text-sm font-semibold transition-opacity duration-300 pointer-events-none opacity-0">
  </div>
</body>

</html>
